#### Exploring Dynamically Linked Functions . 
source : http://dependencywalker.com
#### Common DLLS

Kernel32.dll [access and manipulation of memery, files , hardware] 

advapi32.dll [service manager , registery ] 

user32.dll [buttons,scroll,bars,controlling users actions ]

gdi32.dll [displaying graphics ] 

ntdll.dll [windows kernel ]

Wsock32.dll [network related tasks] 

wininet.dll [FTP,HTTP,NTP] 


### DLLS and Functions used by Malwares keyloggers 
kernel32.dll 
<pre>
CreateFileW
FindFirstFilew (search in Directories)
FindNextfilew (search in Dirctories)
GetCurrentProccess
GetProccessHeap
OpenProcess
ReadFile
WriteFile
</pre>
user32.dll
<pre>
ShowWindow 
SetWindowHookEx (recieve Keyboards inputs)
RegisterHotKey ( Recieve Keyboards hotkeys shortcuts)
RegisterClassExw
SetWindowTextW
</pre>
shell32.dll 
<pre>
ShellexecuteExw
shellexecutew
CommandLineToargw
SHgetFolderw
</pre>
Advapi32.dll 
<pre>
regclosekey
regsetValueExw
</pre>

### PE File For a windows Executables 

<pre>
.text Contains the executable code 
.rdata read-only date 
.data Stores Global Data 
.idata functions information 
.edata export functions information
.pdata only in 64-bit stores exceptions handling 
.rsrc stores resources 
.reloc information about relocation of library files 
</pre>

### PE Header Summery 

|  Field        | information   | 
| ------------- |:-------------:|
imports         |   Functions from other libraries  
Exports         |    Functions in Malware called by other programs 
Time Date       |    Time when program is complied 
Sections        |    Name of section in file , size on disk and memory 
Subsystem       |    whether program is Command line or GUI 
Resources       |    strings , icons , menu , ..

### using PE viewer in unpackedkeylogger.exe 

|Section        | Virtual size  |Size of Raw data| 
| ------------- |:-------------:|---------------:|
.text           |7AF5           |7C00            | 
.data           |17A0           |0200            |
.rdata          |1AF5           |1C00            |
.rsrc           |72B8           |7400            |


### using PE viewer in Packedkeylogger.exe 

|Section        | Virtual size  |Size of Raw data| 
| ------------- |:-------------:|---------------:|
.text           |A000           |  000
.data           |3000           |  0200 
.rdata          |4000           |  0000
.rsrc           |19000          | 3400
dijfpds         |20000          |  0000
.sdfuok         |34000          | 3313F
Kijijl          |1000           | 0200 

notice : if virtual Size of section name is larger that raw data means it is packed . 


+ tools to use 
1. PE Viewer 
2. Dependency Walker http://dependencywalker.com
3. Resource Hacker http://angusj.com
4. PE Browser Professional http://smidgeonsoft.prohosting.com
5. PE explorer  http://heaventools.com 
